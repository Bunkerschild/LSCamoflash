# 🚀 LSCamoflash – Free Your LSC Cam! 🔓

LSCamoflash allows you to free LSC cameras from the cloud and use **local** RTSP streaming. Special thanks to [guino](https://github.com/guino/LSCOutdoor1080P), whose project served as the foundation for this modification. 🙌

⚠ **Disclaimer:** The use of this hack is **at your own risk**. I accept **no liability** for any damage to devices or persons. ⚠

🔍 **Antivirus Warning:** Some antivirus programs, such as **Bitdefender**, falsely detect **Gen:Variant.Trojan.Linux.Specter.1** as a virus, in tcpdump. This is a **false positive**. More information can be found on [VirusTotal](https://www.virustotal.com/gui/file/2136a323071c9f1ae52b45996b8b4045827bcf666e1494579500c22bdfdda934).  

## ✨ Features
✅ **Telnet server on port 24** *(Login: `root` / `LSCamoflash`)*  
✅ **Web server on port 8080** *(e.g., for PTZ control of rotating cameras)*  
✅ **FTP access on port 21** *(Access to the SD card)*  
✅ **ONVIF server for camera integration** *(Support for ONVIF-compatible clients!)*  
✅ **Firmware remains untouched** *(No permanent modification!)*  
✅ **Configurable offline mode** *(Completely disconnects the camera from the Tuya cloud)*  
✅ **Update function** *(Keeps the hack up to date, even for multiple cameras!)*  
✅ **RTSP streaming** *(Currently available for only two models:)*  
   - 📌 **PTZ Indoor Camera (1080p)**  
   - 📌 **Static Outdoor Camera (1080p)**  
   *(Check `PATCH` to see if your camera model is supported.)*

## ⚙️ Technical Background
🛠️ The camera is tricked by an **empty file** `_ht_ap_mode.conf` into thinking it needs to start **AP mode**.  
🛠️ A **modified `hostapd`** then launches the actual hack.  

🚫 **After `hostapd` starts, the following happens:**  
🔹 **Prevention of automatic firmware updates** to keep the security vulnerability open.  
🔹 **Offline mode can be activated via a configuration file**, blocking any connection to the Tuya cloud.  
🔹 **Update function** keeps the hack up to date and allows updates for multiple cameras simultaneously.  

## 🔄 Workflow of init.sh and services.sh
### 🏁 **`init.sh` (Initialization Script)**
This central startup script runs directly after the camera boots up:  
1️⃣ **Checks the SD card** *(Is it recognized? Is the filesystem correct?)*  
2️⃣ **Sets environment variables** *(Important for later scripts)*  
3️⃣ **Starts `services.sh`** to activate all background services.  

### ⚡ **`services.sh` (Starts services and blocks cloud connections)**
2️⃣ **Starts the Telnet server (Port 24)** *(Login: `root` / `LSCamoflash`)*  
3️⃣ **Activates the web server (Port 8080)** *(For PTZ camera control)*  
4️⃣ **Starts the FTP server (Port 21)** *(Access to the SD card)*  
5️⃣ **Starts the ONVIF server** to integrate the camera into ONVIF-compatible systems.  
6️⃣ **Checks if offline mode is active** *(If enabled, all cloud connections are blocked!)*  
7️⃣ **Enables future updates** *(Even for multiple cameras simultaneously!)*  

## 🔮 Future Plans
🚧 **Planned:** Automatic **anyka_ipc** patching at camera boot, eliminating the need for a static patch!  

## 📥 Installation
1️⃣ Download the repository or clone it using Git.  
2️⃣ Copy the contents of the `SDCARD` directory onto a **FAT32-formatted** SD card.  
3️⃣ **Insert the SD card into the camera and restart it.**  
4️⃣ Wait a few moments – Telnet, FTP, ONVIF, and the web server should now be available.  

## 🛠️ Troubleshooting
🔴 **Blue LED blinks continuously?**
   - Remove the SD card and delete the file `HACK/usr/patch/<MD5-CHECKSUM>/bin/anyka_ipc_patched`.
   - If the problem persists, also remove `anyka_ipc` from the same directory.

🔴 **RTSP or Telnet not working?**
   - Check if the file `_ht_ap_mode.conf` exists on the SD card.
   - Ensure the SD card is **formatted as FAT32**.

## 🔍 Version Check
Verify whether the patch has been applied correctly:
```sh
md5sum /usr/bin/anyka_ipc
```
Compare the output with `SDCARD/HACK/etc/hack.conf` under `Static patch supported`.

## 🛠️ Useful Tools
LSCamoflash includes the following additional tools:
✅ **BusyBox (latest version) with all common applets**  
✅ **Mosquitto_pub (MQTT client)**  
✅ **OpenSSL for secure connections**  
✅ **cURL with HTTPS support**  
✅ **joe (simple text editor)**  
✅ **SQLite3 and SQLCipher for database management**  
✅ **strace for process monitoring and debugging**  
✅ **tcpdump for network analysis**  

🚀 **LSCamoflash is the best solution to free LSC cameras from the cloud and take full control of your devices!** 🔥

*This text was generated by AI.*

---

# 🚀 LSCamoflash – Befreie deine LSC Cam! 🔓

LSCamoflash ermöglicht es, LSC-Kameras von der Cloud zu befreien und RTSP-Streaming **lokal** zu nutzen. Ein besonderer Dank geht an [guino](https://github.com/guino/LSCOutdoor1080P), dessen Projekt als Grundlage für diese Modifikation diente. 🙌

⚠ **Hinweis:** Die Verwendung dieses Hacks geschieht auf **eigene Gefahr**. Ich übernehme **keinerlei Haftung** für Schäden an Geräten oder Personen. ⚠

🔍 **Antivirenwarnung:** Einige Virenscanner, wie z. B. **Bitdefender**, erkennen fälschlicherweise den Virus **Gen:Variant.Trojan.Linux.Specter.1** in der Datei tcpdump. Dies ist ein **False-Positive**. Weitere Informationen findest du auf [VirusTotal](https://www.virustotal.com/gui/file/2136a323071c9f1ae52b45996b8b4045827bcf666e1494579500c22bdfdda934).  

## ✨ Funktionen
✅ **Telnet-Server auf Port 24** *(Login: `root` / `LSCamoflash`)*  
✅ **Webserver auf Port 8080** *(z.B. zur PTZ-Steuerung bei schwenkbaren Kameras)*  
✅ **FTP-Zugang auf Port 21** *(Zugriff auf die Speicherkarte)*  
✅ **ONVIF-Server zur Kamera-Integration** *(Unterstützung für ONVIF-kompatible Clients!)*  
✅ **Firmware bleibt unangetastet** *(keine dauerhafte Modifikation!)*  
✅ **Offline-Modus konfigurierbar** *(Kamera vollständig von der Tuya-Cloud trennen)*  
✅ **Update-Funktion** *(Hält den Hack aktuell, auch für mehrere Kameras!)*  
✅ **RTSP-Streaming** *(Derzeit nur für zwei Modelle verfügbar:)*  
   - 📌 **PTZ Indoor Kamera (1080p)**  
   - 📌 **Statische Außenkamera (1080p)**  
   *(Siehe `PATCH`, um zu prüfen, ob dein Kameramodell unterstützt wird.)*

## ⚙️ Technischer Hintergrund
🛠️ Die Kamera wird durch eine **leere Datei** `_ht_ap_mode.conf` getäuscht, dass sie den **AP-Modus** starten muss.  
🛠️ Eine **manipulierte `hostapd`** startet daraufhin den eigentlichen Hack.  

🚫 **Nach dem Start von `hostapd` passiert folgendes:**  
🔹 **Verhinderung automatischer Firmware-Updates**, um die Sicherheitslücke offen zu halten.  
🔹 **Offline-Modus kann per Konfigurationsdatei aktiviert werden**, sodass keine Tuya-Cloud-Verbindung mehr möglich ist.  
🔹 **Update-Funktion**, um den Hack aktuell zu halten und mehrere Kameras gleichzeitig zu aktualisieren.  

## 🔄 Ablauf von init.sh und services.sh
### 🏁 **`init.sh` (Initialisierungsskript)**
Das zentrale Startskript, das direkt nach dem Booten der Kamera ausgeführt wird:  
1️⃣ **Überprüfung der SD-Karte** *(wird sie erkannt? Ist das Dateisystem korrekt?)*  
2️⃣ **Setzen der Umgebungsvariablen** *(wichtig für spätere Skripte)*  
3️⃣ **Start von `services.sh`**, um alle Hintergrunddienste zu aktivieren.  

### ⚡ **`services.sh` (Startet Dienste und blockiert Cloud-Verbindungen)**
2️⃣ **Startet den Telnet-Server (Port 24)** *(Login: `root` / `LSCamoflash`)*  
3️⃣ **Aktiviert den Webserver (Port 8080)** *(Steuerung für PTZ-Kameras)*  
4️⃣ **Startet den FTP-Server (Port 21)** *(Zugriff auf die SD-Karte)*  
5️⃣ **Startet den ONVIF-Server**, um die Kamera in ONVIF-kompatible Systeme zu integrieren.  
6️⃣ **Prüft, ob der Offline-Modus aktiv ist** *(falls ja, wird jede Verbindung zur Cloud blockiert!)*  
7️⃣ **Ermöglicht zukünftige Updates** *(auch für mehrere Kameras gleichzeitig!)*  

## 🔮 Zukunftspläne
🚧 **Geplant:** Automatische **anyka_ipc**-Patches beim Booten der Kamera, sodass kein statischer Patch mehr nötig ist!  

## 📥 Installation
1️⃣ Lade das Repository herunter oder klone es mit Git.  
2️⃣ Kopiere den Inhalt des `SDCARD`-Verzeichnisses auf eine **FAT32-formatierte** SD-Karte.  
3️⃣ **Setze die SD-Karte in die Kamera ein und starte sie neu.**  
4️⃣ Warte einige Momente – danach sollten Telnet, FTP, ONVIF und der Webserver verfügbar sein.  

## 🛠️ Fehlerbehebung
🔴 **Blaue LED blinkt dauerhaft?**
   - SD-Karte entfernen und Datei `HACK/usr/patch/<MD5-CHECKSUM>/bin/anyka_ipc_patched` löschen.
   - Falls das Problem weiterhin besteht, auch `anyka_ipc` entfernen.

🔴 **RTSP oder Telnet funktionieren nicht?**
   - Prüfen, ob die Datei `_ht_ap_mode.conf` auf der SD-Karte existiert.
   - Sicherstellen, dass die SD-Karte **FAT32-formatiert** ist.

## 🔍 Versionsprüfung
Überprüfen, ob der Patch korrekt angewendet wurde:
```sh
md5sum /usr/bin/anyka_ipc
```
Vergleiche die Ausgabe mit `SDCARD/HACK/etc/hack.conf` unter `Static patch supported`.

## 🛠️ Nützliche Tools
LSCamoflash enthält folgende zusätzliche Werkzeuge:
✅ **BusyBox (aktuelle Version) mit allen gängigen Applets**  
✅ **Mosquitto_pub (MQTT Client)**  
✅ **OpenSSL für sichere Verbindungen**  
✅ **cURL mit HTTPS-Unterstützung**  
✅ **joe (einfacher Texteditor)**  
✅ **SQLite3 und SQLCipher für Datenbankmanagement**  
✅ **strace zur Prozessüberwachung und Fehlersuche**  
✅ **tcpdump zur Netzwerkanalyse**  

🚀 **LSCamoflash ist die beste Lösung, um LSC-Kameras von der Cloud zu befreien und volle Kontrolle über deine Geräte zu erhalten!** 🔥

*Dieser Text wurde KI-generiert.*
